<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è¶£å‘³åŠ¨ç”»è¯¾ï¼š1-3 å¹´çº§æ•°å­¦ä¸ç§‘å­¦</title>
  <link rel="stylesheet" href="../assets/css/pigeonhole.css" />
  <style>
    body {
      background: #f6fbff;
    }

    .container {
      max-width: 1080px;
    }

    .lesson-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 18px;
    }

    .lesson-card {
      background: #ffffff;
      border-radius: 14px;
      border: 1px solid #e3eefc;
      padding: 16px 18px;
      box-shadow: 0 8px 20px rgba(46, 125, 240, 0.08);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .lesson-card h3 {
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 20px;
      color: #1a4f9c;
    }

    .tag {
      display: inline-flex;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      background: #e8f2ff;
      color: #1c5fb7;
    }

    .action-area {
      background: linear-gradient(180deg, #f6faff 0%, #eef3ff 100%);
      border: 1px dashed #c5d9ff;
      border-radius: 12px;
      padding: 12px;
      min-height: 150px;
      position: relative;
      overflow: hidden;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .small-note {
      font-size: 13px;
      color: #446;
      margin: 0;
    }

    /* 1) åŠ æ³•æ³¡æ³¡ */
    .bubble-wrap {
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
    }

    .bubble {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      display: grid;
      place-items: center;
      font-size: 26px;
      font-weight: 700;
      color: #0d47a1;
      background: radial-gradient(circle at 30% 30%, #fff, #badeff);
      border: 2px solid #7eb5ff;
      box-shadow: 0 6px 14px rgba(13, 71, 161, 0.18);
      animation: float 3s ease-in-out infinite;
    }

    .bubble.pop {
      animation: pop 0.35s ease-out;
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-6px);
      }
    }

    @keyframes pop {
      0% {
        transform: scale(0.8);
      }
      60% {
        transform: scale(1.18);
      }
      100% {
        transform: scale(1);
      }
    }

    .jar {
      flex: 1;
      min-width: 160px;
      background: #fff;
      border-radius: 12px;
      padding: 8px;
      border: 2px solid #b8d6ff;
      box-shadow: inset 0 8px 14px rgba(0, 85, 180, 0.08);
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      min-height: 80px;
    }

    .candy {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      background: linear-gradient(135deg, #ffcc80, #ffb74d);
      display: grid;
      place-items: center;
      font-weight: 700;
      color: #5d3b00;
      animation: drop 0.35s ease-out;
    }

    @keyframes drop {
      0% {
        transform: translateY(-12px);
        opacity: 0;
      }
      100% {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* 2) å‡æ³•é‡é¤ */
    .picnic-area {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .carrot {
      font-size: 28px;
      transition: transform 0.35s ease, opacity 0.35s ease;
    }

    .carrot.taken {
      transform: translateY(18px) rotate(-10deg);
      opacity: 0.2;
    }

    /* 3) å›¾å½¢åˆ†ç±»æ¸¸ä¹å›­ */
    .shape-board {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    .shape {
      height: 64px;
      display: grid;
      place-items: center;
      font-weight: 700;
      cursor: pointer;
      color: #fff;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .shape.selected {
      transform: translateY(-4px) scale(1.05);
      box-shadow: 0 10px 16px rgba(0, 0, 0, 0.12);
      outline: 3px solid #fff;
    }

    .shape.round {
      background: #ff8a65;
      border-radius: 50%;
    }

    .shape.square {
      background: #4db6ac;
      border-radius: 14px;
    }

    .shape.triangle {
      background: #7986cb;
      clip-path: polygon(50% 8%, 6% 92%, 94% 92%);
    }

    .buckets {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 12px;
    }

    .bucket {
      background: #ffffff;
      border: 2px dashed #90b6ff;
      border-radius: 12px;
      padding: 10px;
      min-height: 80px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-start;
    }

    /* 4) é•¿çŸ­æ¯”è¾ƒ */
    .bar-wrap {
      display: grid;
      gap: 8px;
    }

    .length-bar {
      background: linear-gradient(90deg, #ffcdd2, #ef9a9a);
      height: 26px;
      border-radius: 18px;
      position: relative;
      transition: transform 0.25s ease;
      cursor: pointer;
      overflow: hidden;
    }

    .length-bar.b {
      background: linear-gradient(90deg, #b3e5fc, #81d4fa);
    }

    .length-bar:hover {
      transform: translateX(4px);
    }

    .length-bar .label {
      position: absolute;
      left: 10px;
      top: 4px;
      color: #333;
      font-weight: 700;
    }

    /* 5) é˜µåˆ— */
    .grid-preview {
      display: grid;
      gap: 6px;
      justify-content: start;
    }

    .grid-row {
      display: flex;
      gap: 4px;
    }

    .tile {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      display: grid;
      place-items: center;
      background: #fff3e0;
      border: 1px solid #ffcc80;
      animation: pop 0.3s ease-out;
    }

    /* 6) æ—¶é’Ÿ */
    .clock-box {
      display: flex;
      gap: 16px;
      align-items: center;
      flex-wrap: wrap;
    }

    .clock {
      width: 160px;
      height: 160px;
      border-radius: 50%;
      border: 4px solid #90caf9;
      position: relative;
      background: #fff;
      box-shadow: inset 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    .clock .center {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #0d47a1;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 3;
    }

    .clock .hand {
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform-origin: bottom center;
      transform: translateX(-50%) rotate(0deg);
      transition: transform 0.5s ease;
      border-radius: 8px;
    }

    .hand.hour {
      width: 8px;
      height: 44px;
      background: #1565c0;
      z-index: 2;
    }

    .clock .marks {
      position: absolute;
      inset: 8px;
    }

    .clock .marks span {
      position: absolute;
      width: 4px;
      height: 10px;
      background: #bbdefb;
      left: 50%;
      top: 2px;
      transform-origin: center 68px;
    }

    /* 7) æ¤ç‰©æˆé•¿ */
    .garden {
      display: flex;
      gap: 10px;
      align-items: flex-end;
    }

    .pot {
      width: 90px;
      height: 48px;
      background: linear-gradient(180deg, #f57c00, #e65100);
      border-radius: 0 0 18px 18px;
      position: relative;
      overflow: visible;
    }

    .soil {
      position: absolute;
      top: -10px;
      left: 0;
      right: 0;
      height: 14px;
      background: #6d4c41;
      border-radius: 50% 50% 0 0;
    }

    .plant {
      position: absolute;
      bottom: 14px;
      left: 50%;
      transform: translateX(-50%);
      width: 12px;
      background: #4caf50;
      border-radius: 10px;
      transition: height 0.5s ease;
      height: 20px;
    }

    .leaf {
      position: absolute;
      width: 28px;
      height: 12px;
      background: #66bb6a;
      border-radius: 10px;
      top: 20%;
      left: 50%;
      transform: translateX(-50%) rotate(-6deg);
    }

    .leaf.right {
      transform: translateX(-50%) rotate(16deg);
      top: 38%;
    }

    .flower {
      position: absolute;
      bottom: calc(100% - 6px);
      left: 50%;
      transform: translateX(-50%) scale(0);
      width: 46px;
      height: 46px;
      background: radial-gradient(circle at 50% 50%, #fff176 0 22px, #f06292 22px 100%);
      border-radius: 50%;
      transition: transform 0.4s ease;
    }

    .flower.show {
      transform: translateX(-50%) scale(1);
    }

    /* 8) å¤©æ°”ç®± */
    .weather-box {
      position: relative;
      height: 170px;
      border-radius: 14px;
      overflow: hidden;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      font-weight: 700;
      transition: background 0.4s ease;
    }

    .cloud {
      position: absolute;
      top: 40px;
      left: 20px;
      width: 90px;
      height: 50px;
      background: #fff;
      border-radius: 50px;
      box-shadow: 45px 10px 0 10px #fff, 80px 20px 0 0 #fff;
      opacity: 0;
      animation: drift 12s linear infinite;
    }

    #rain-layer {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .cloud.show {
      opacity: 0.9;
    }

    @keyframes drift {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(120%);
      }
    }

    .raindrop {
      position: absolute;
      width: 3px;
      height: 12px;
      background: #e3f2fd;
      border-radius: 6px;
      bottom: 0;
      left: 10%;
      animation: rain 1s linear infinite;
      opacity: 0;
    }

    @keyframes rain {
      0% {
        transform: translateY(-160px);
        opacity: 0;
      }
      30% {
        opacity: 1;
      }
      100% {
        transform: translateY(0);
        opacity: 0;
      }
    }

    .sun {
      position: absolute;
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff59d, #fbc02d 45%, #f57f17 100%);
      top: 18px;
      right: 18px;
      box-shadow: 0 0 25px rgba(255, 193, 7, 0.6);
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }

    .sun.show {
      opacity: 1;
      transform: scale(1) rotate(20deg);
      animation: spin 8s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: scale(1) rotate(0deg);
      }
      100% {
        transform: scale(1) rotate(360deg);
      }
    }

    .feedback {
      margin: 0;
      font-weight: 700;
      color: #0d47a1;
    }
  </style>
</head>
<body data-topic="early-animations">
  <div class="container">
    <header class="page-header">
      <nav class="top-nav">
        <a class="back-link" href="../index.html">â† è¿”å›é¢˜ç›®åˆ—è¡¨</a>
      </nav>
      <h1>è¶£å‘³åŠ¨ç”»è¯¾ï¼š1-3 å¹´çº§æ•°å­¦ä¸ç§‘å­¦</h1>
      <p class="subtitle">
        æ¯ä¸ªå°æ´»åŠ¨èšç„¦ 1 ä¸ªæ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œç»“åˆå¡é€šæƒ…å¢ƒä¸è½»é‡äº¤äº’ï¼Œå¸®åŠ©å­©å­åœ¨ç©ä¸­ç†è§£æ¦‚å¿µã€‚
      </p>
    </header>

    <main class="main-content lesson-grid">
      <!-- 1. 10 ä»¥å†…åŠ æ³• -->
      <article class="lesson-card" id="lesson-add">
        <h3><span class="tag">æ•°å­¦ Â· ä¸€å¹´çº§</span>åŠ æ³•æ³¡æ³¡ï¼šé›¶é£Ÿåº—å‡‘ä»½æ•°</h3>
        <p class="small-note">åœºæ™¯ï¼šå°ç†Šå’Œå°å…”åœ¨é›¶é£Ÿåº—å„æ‹¿äº†å‡ é¢—ç³–ï¼Œç‚¹å‡»â€œæ˜¾ç¤ºç­”æ¡ˆâ€è®©ç³–æœè·³è¿›ç»ç’ƒç“¶ï¼Œçœ‹åˆ°æ€»æ•°ã€‚</p>
        <div class="action-area">
          <div class="bubble-wrap">
            <div class="bubble" id="add-num-a">3</div>
            <span style="font-size:22px;font-weight:700;color:#1a4f9c;">+</span>
            <div class="bubble" id="add-num-b">4</div>
            <span style="font-size:22px;font-weight:700;color:#1a4f9c;">=</span>
            <div class="bubble" id="add-answer" aria-live="polite">?</div>
            <div class="jar" id="candy-jar"></div>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn" type="button" id="add-refresh">æ¢ä¸€ç»„æ•°å­—</button>
          <button class="btn btn-primary" type="button" id="add-show">æ˜¾ç¤ºç­”æ¡ˆ</button>
        </div>
      </article>

      <!-- 2. 10 ä»¥å†…å‡æ³• -->
      <article class="lesson-card" id="lesson-sub">
        <h3><span class="tag">æ•°å­¦ Â· ä¸€å¹´çº§</span>é‡é¤åˆ†äº«ï¼šè‹¹æœæ‹¿èµ°è¿˜å‰©å‡ é¢—</h3>
        <p class="small-note">åœºæ™¯ï¼šè‰åœ°é‡é¤ç¯®é‡Œæœ‰ä¸€æ‰¹è‹¹æœï¼Œå­©å­æ‹–èµ°ï¼ˆç‚¹å‡»ï¼‰å‡ é¢—é€ç»™æœ‹å‹ï¼Œè§‚å¯Ÿæ•°é‡å‡å°‘çš„åŠ¨ç”»ã€‚</p>
        <div class="action-area picnic-area" id="apple-box"></div>
        <div class="btn-group">
          <label>æ‹¿èµ° <input type="number" id="take-count" min="1" max="5" value="2" style="width:60px;"> é¢—</label>
          <button class="btn" type="button" id="sub-refresh">é‡æ–°è£…ç¯®</button>
          <button class="btn btn-primary" type="button" id="sub-take">å¼€å§‹æ‹¿èµ°</button>
          <p class="feedback" id="sub-feedback"></p>
        </div>
      </article>

      <!-- 3. å›¾å½¢åˆ†ç±» -->
      <article class="lesson-card" id="lesson-shape">
        <h3><span class="tag">æ•°å­¦ Â· äºŒå¹´çº§</span>æ¸¸ä¹å›­æ°”çƒï¼šåœ†å½¢ vs. å°–è§’å½¢</h3>
        <p class="small-note">åœºæ™¯ï¼šæ°”çƒåº—æ¥äº†ä¸åŒå½¢çŠ¶çš„æ°”çƒï¼Œç‚¹å‡»ä¸€ä¸ªæ°”çƒå†ç‚¹å‡»å¯¹åº”ç¯®å­ï¼ˆåœ†åœ†ç¯® / å°–è§’ç¯®ï¼‰å®Œæˆåˆ†ç±»ã€‚</p>
        <div class="action-area">
          <div class="shape-board" id="shape-board"></div>
          <div class="buckets">
            <div class="bucket" data-type="round">
              <strong>åœ†åœ†ç¯®</strong>
            </div>
            <div class="bucket" data-type="corner">
              <strong>å°–è§’ç¯®</strong>
            </div>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn" type="button" id="shape-reset">é‡æ–°æ··åˆæ°”çƒ</button>
          <p class="feedback" id="shape-feedback"></p>
        </div>
      </article>

      <!-- 4. é•¿çŸ­æ¯”è¾ƒ -->
      <article class="lesson-card" id="lesson-length">
        <h3><span class="tag">æ•°å­¦ Â· äºŒå¹´çº§</span>é“…ç¬”æ¯”ä¸€æ¯”ï¼šè°æ›´é•¿ï¼Ÿ</h3>
        <p class="small-note">åœºæ™¯ï¼šæ–‡å…·åº—é‡Œä¸¤æ”¯å½©è‰²é“…ç¬”æ¨ªå‘æ‘†æ”¾ï¼Œå­©å­ç‚¹å‡»è§‰å¾—æ›´é•¿çš„ä¸€æ”¯ï¼Œç«‹å³æ˜¾ç¤ºå¯¹é”™ä¸å·®å€¼ã€‚</p>
        <div class="action-area">
          <div class="bar-wrap">
            <div class="length-bar a" id="bar-a"><span class="label">ç²‰è‰²é“…ç¬”</span></div>
            <div class="length-bar b" id="bar-b"><span class="label">è“è‰²é“…ç¬”</span></div>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn" type="button" id="length-refresh">ç”Ÿæˆæ–°é•¿åº¦</button>
          <p class="feedback" id="length-feedback"></p>
        </div>
      </article>

      <!-- 5. é˜µåˆ—ä¸ä¹˜æ³• -->
      <article class="lesson-card" id="lesson-array">
        <h3><span class="tag">æ•°å­¦ Â· äºŒ/ä¸‰å¹´çº§</span>èŠ±å›é˜µåˆ—ï¼šé‡å¤åŠ æ³•åˆ°ä¹˜æ³•</h3>
        <p class="small-note">åœºæ™¯ï¼šèŠ±å›­é‡Œè¦ç§æˆè¡Œæˆåˆ—çš„å°é›èŠï¼Œè°ƒæ•´â€œè¡Œâ€å’Œâ€œåˆ—â€ï¼Œçœ‹åˆ°é“ºæ»¡çš„é˜µåˆ—å’Œå¯¹åº”çš„ä¹˜æ³•è¡¨è¾¾ã€‚</p>
        <div class="action-area">
          <div class="btn-group">
            <label>è¡Œæ•° <input type="number" id="row-count" min="1" max="5" value="2" style="width:60px;"></label>
            <label>åˆ—æ•° <input type="number" id="col-count" min="1" max="5" value="3" style="width:60px;"></label>
            <button class="btn" type="button" id="array-refresh">ç”Ÿæˆé˜µåˆ—</button>
          </div>
          <div class="grid-preview" id="grid-preview"></div>
        </div>
        <p class="feedback" id="array-feedback"></p>
      </article>

      <!-- 6. æ•´ç‚¹æ—¶é—´ -->
      <article class="lesson-card" id="lesson-clock">
        <h3><span class="tag">æ•°å­¦ Â· äºŒ/ä¸‰å¹´çº§</span>å°ç«è½¦æ•´ç‚¹ç«™ï¼šè®¤è¯†æ—¶åˆ»</h3>
        <p class="small-note">åœºæ™¯ï¼šå°ç«è½¦æ•´ç‚¹å‘è½¦ï¼Œæ‹–åŠ¨æ—¶é—´æˆ–ç‚¹å‡»ä¸‹ä¸€ç­ï¼ŒæŒ‡é’ˆè½¬åŠ¨å¹¶æ˜¾ç¤ºæ•°å­—æ—¶é—´ã€‚</p>
        <div class="action-area clock-box">
          <div class="clock" aria-label="æ¨¡æ‹Ÿæ—¶é’Ÿ">
            <div class="marks" id="clock-marks"></div>
            <div class="hand hour" id="hour-hand"></div>
            <div class="center"></div>
          </div>
          <div>
            <label>æ•´ç‚¹ï¼š<input type="range" id="hour-input" min="1" max="12" value="3"></label>
            <p class="feedback" id="clock-text"></p>
            <div class="btn-group">
              <button class="btn" type="button" id="prev-train">ä¸Šä¸€ç­</button>
              <button class="btn btn-primary" type="button" id="next-train">ä¸‹ä¸€ç­</button>
            </div>
          </div>
        </div>
      </article>

      <!-- 7. æ¤ç‰©æˆé•¿ -->
      <article class="lesson-card" id="lesson-plant">
        <h3><span class="tag">ç§‘å­¦ Â· ä¸€/äºŒå¹´çº§</span>å‘æ—¥è‘µæˆé•¿æ—¥è®°</h3>
        <p class="small-note">åœºæ™¯ï¼šç»™èŠ±ç›†æµ‡æ°´ã€æ™’å¤ªé˜³ï¼Œè§‚å¯Ÿç§å­â†’å«©èŠ½â†’å¼€èŠ±çš„é«˜åº¦å˜åŒ–ï¼Œç†è§£æ¤ç‰©ç”Ÿé•¿éœ€è¦å…‰å’Œæ°´ã€‚</p>
        <div class="action-area garden">
          <div class="pot">
            <div class="soil"></div>
            <div class="plant" id="plant-stem">
              <div class="leaf"></div>
              <div class="leaf right"></div>
              <div class="flower" id="plant-flower"></div>
            </div>
          </div>
          <div>
            <p class="feedback" id="plant-text">ç§å­ç¡åœ¨åœŸé‡Œï¼Œç­‰å¾…æ°´åˆ†ã€‚</p>
            <div class="btn-group">
              <button class="btn" type="button" id="water-btn">æµ‡æ°´</button>
              <button class="btn btn-primary" type="button" id="sun-btn">æ™’å¤ªé˜³</button>
            </div>
          </div>
        </div>
      </article>

      <!-- 8. å¤©æ°”å˜åŒ– -->
      <article class="lesson-card" id="lesson-weather">
        <h3><span class="tag">ç§‘å­¦ Â· äºŒ/ä¸‰å¹´çº§</span>å¤©æ°”è¡£æŸœï¼šç©¿è¡£ä¸å¤©æ°”åŒ¹é…</h3>
        <p class="small-note">åœºæ™¯ï¼šç‚¹å‡»ä¸åŒå¤©æ°”æŒ‰é’®ï¼Œå¤©ç©ºã€å¤ªé˜³ã€é›¨æ»´åŠ¨ç”»åŒæ—¶å˜åŒ–ï¼Œæ—è¾¹æç¤ºå‡ºè¡Œå»ºè®®ã€‚</p>
        <div class="action-area" style="padding:0;">
          <div class="weather-box" id="weather-box">
            <div class="sun" id="weather-sun"></div>
            <div class="cloud" id="weather-cloud"></div>
            <div id="rain-layer"></div>
            <span id="weather-emoji">â˜€ï¸</span>
          </div>
        </div>
        <div class="btn-group">
          <button class="btn" type="button" data-weather="sunny">æ™´æœ—</button>
          <button class="btn" type="button" data-weather="cloudy">å¤šäº‘</button>
          <button class="btn btn-primary" type="button" data-weather="rainy">ä¸‹é›¨</button>
          <p class="feedback" id="weather-text"></p>
        </div>
      </article>
    </main>
    <footer class="page-footer">
      <p>åˆ¶ä½œè€…ï¼šå¹¿ä¸œçœä½›å±±å¸‚ç¦…åŸåŒºå—åº„é•‡å‰åˆ©å°å­¦</p>
      <p>â€”â€”ä½•æ€é”è€å¸ˆ</p>
  </footer>
</div>

  <script>
    const $ = (sel) => document.querySelector(sel);

    document.addEventListener("DOMContentLoaded", () => {
      initAddition();
      initSubtraction();
      initShapes();
      initLength();
      initArray();
      initClock();
      initPlant();
      initWeather();
    });

    // 1) åŠ æ³•æ³¡æ³¡
    function initAddition() {
      const aEl = $("#add-num-a");
      const bEl = $("#add-num-b");
      const ansEl = $("#add-answer");
      const jar = $("#candy-jar");

      const setNumbers = () => {
        const a = rand(1, 5);
        const b = rand(1, 5);
        aEl.textContent = a;
        bEl.textContent = b;
        ansEl.textContent = "?";
        ansEl.classList.remove("pop");
        jar.innerHTML = "";
      };

      const showSum = () => {
        const sum = Number(aEl.textContent) + Number(bEl.textContent);
        ansEl.textContent = sum;
        ansEl.classList.remove("pop");
        void ansEl.offsetWidth; // é‡æ–°è§¦å‘åŠ¨ç”»
        ansEl.classList.add("pop");
        jar.innerHTML = "";
        for (let i = 1; i <= sum; i++) {
          const candy = document.createElement("div");
          candy.className = "candy";
          candy.textContent = "ğŸ¬";
          candy.style.animationDelay = `${i * 40}ms`;
          jar.appendChild(candy);
        }
      };

      $("#add-refresh").addEventListener("click", setNumbers);
      $("#add-show").addEventListener("click", showSum);
      setNumbers();
    }

    // 2) å‡æ³•é‡é¤
    function initSubtraction() {
      const box = $("#apple-box");
      const takeInput = $("#take-count");
      const feedback = $("#sub-feedback");
      let total = 0;

      const fillBasket = () => {
        total = rand(6, 10);
        box.innerHTML = "";
        feedback.textContent = "";
        for (let i = 0; i < total; i++) {
          const apple = document.createElement("span");
          apple.textContent = "ğŸ";
          apple.className = "carrot";
          apple.dataset.taken = "0";
          box.appendChild(apple);
        }
        takeInput.value = 2;
      };

      const take = () => {
        const need = Math.min(Number(takeInput.value) || 1, total);
        let taken = 0;
        box.querySelectorAll(".carrot").forEach((el) => {
          if (taken < need && el.dataset.taken === "0") {
            el.dataset.taken = "1";
            el.classList.add("taken");
            taken += 1;
          }
        });
        const left = total - taken;
        total = left;
        feedback.textContent = `æ‹¿èµ° ${taken} é¢—ï¼Œè¿˜å‰© ${left} é¢—ã€‚`;
      };

      $("#sub-refresh").addEventListener("click", fillBasket);
      $("#sub-take").addEventListener("click", take);
      fillBasket();
    }

    // 3) å›¾å½¢åˆ†ç±»
    function initShapes() {
      const board = $("#shape-board");
      const feedback = $("#shape-feedback");
      let selected = null;

      const shapes = [
        { type: "round", label: "åœ†" },
        { type: "round", label: "åœ†" },
        { type: "corner", label: "ä¸‰" },
        { type: "corner", label: "æ–¹" },
        { type: "round", label: "åœ†" },
        { type: "corner", label: "è§’" }
      ];

      const render = () => {
        board.innerHTML = "";
        feedback.textContent = "";
        selected = null;
        [...shapes].sort(() => Math.random() - 0.5).forEach((item, idx) => {
          const el = document.createElement("div");
          el.className = `shape ${item.type === "round" ? "round" : item.label === "æ–¹" ? "square" : "triangle"}`;
          el.textContent = item.label;
          el.dataset.type = item.type;
          el.dataset.index = idx;
          el.addEventListener("click", () => {
            board.querySelectorAll(".shape").forEach((s) => s.classList.remove("selected"));
            selected = el;
            el.classList.add("selected");
          });
          board.appendChild(el);
        });
        document.querySelectorAll(".bucket").forEach((bucket) => {
          bucket.innerHTML = `<strong>${bucket.dataset.type === "round" ? "åœ†åœ†ç¯®" : "å°–è§’ç¯®"}</strong>`;
        });
      };

      // å°†å½“å‰é€‰ä¸­çš„å½¢çŠ¶æ”¾å…¥ç¯®å­
      const handleDrop = (bucket) => {
        if (!selected) {
          feedback.textContent = "è¯·å…ˆç‚¹å‡»ä¸€ä¸ªæ°”çƒã€‚";
          return;
        }
        const ok = selected.dataset.type === bucket.dataset.type;
        if (ok) {
          selected.classList.remove("selected");
          selected.style.cursor = "default";
          bucket.appendChild(selected);
          feedback.textContent = "åˆ†ç±»æ­£ç¡®ï¼ç»§ç»­åŠ æ²¹ï½";
        } else {
          feedback.textContent = "ç¯®å­é€‰é”™äº†ï¼Œå†æƒ³æƒ³ã€‚";
          selected.classList.add("pop");
          setTimeout(() => selected.classList.remove("pop"), 300);
        }
        selected = null;
      };

      document.querySelectorAll(".bucket").forEach((bucket) => {
        bucket.addEventListener("click", () => handleDrop(bucket));
      });

      $("#shape-reset").addEventListener("click", render);
      render();
    }

    // 4) é•¿çŸ­æ¯”è¾ƒ
    function initLength() {
      const barA = $("#bar-a");
      const barB = $("#bar-b");
      const feedback = $("#length-feedback");
      let lenA = 0;
      let lenB = 0;

      const setLengths = () => {
        lenA = rand(70, 150);
        lenB = rand(70, 150);
        barA.style.width = `${lenA}px`;
        barB.style.width = `${lenB}px`;
        feedback.textContent = "";
      };

      const check = (choice) => {
        const right = lenA === lenB ? null : lenA > lenB ? "A" : "B";
        if (right === null) {
          feedback.textContent = "ä¸¤æ”¯ä¸€æ ·é•¿ï¼";
          return;
        }
        const delta = Math.abs(lenA - lenB);
        const correct = choice === right;
        feedback.textContent = correct
          ? `ç­”å¯¹å•¦ï¼å·®å€¼çº¦ ${delta} åƒç´ ã€‚`
          : `å†è¯•è¯•ï¼Ÿæ­£ç¡®çš„æ˜¯ ${right}ï¼Œå·®çº¦ ${delta} åƒç´ ã€‚`;
      };

      barA.addEventListener("click", () => check("A"));
      barB.addEventListener("click", () => check("B"));
      $("#length-refresh").addEventListener("click", setLengths);
      setLengths();
    }

    // 5) é˜µåˆ—
    function initArray() {
      const rowsInput = $("#row-count");
      const colsInput = $("#col-count");
      const preview = $("#grid-preview");
      const feedback = $("#array-feedback");

      const render = () => {
        const r = clamp(Number(rowsInput.value) || 1, 1, 5);
        const c = clamp(Number(colsInput.value) || 1, 1, 5);
        rowsInput.value = r;
        colsInput.value = c;
        preview.innerHTML = "";
        for (let i = 0; i < r; i++) {
          const row = document.createElement("div");
          row.className = "grid-row";
          for (let j = 0; j < c; j++) {
            const tile = document.createElement("div");
            tile.className = "tile";
            tile.textContent = "ğŸŒ¼";
            tile.style.animationDelay = `${(i + j) * 60}ms`;
            row.appendChild(tile);
          }
          preview.appendChild(row);
        }
        const total = r * c;
        feedback.textContent = `${r} è¡Œ Ã— ${c} åˆ— = ${total} æœµï¼Œå¯ä»¥å†™æˆ ${r} æ¬¡ ${c} çš„é‡å¤åŠ æ³•ã€‚`;
      };

      $("#array-refresh").addEventListener("click", render);
      rowsInput.addEventListener("change", render);
      colsInput.addEventListener("change", render);
      render();
    }

    // 6) æ—¶é’Ÿ
    function initClock() {
      const marks = $("#clock-marks");
      const hand = $("#hour-hand");
      const slider = $("#hour-input");
      const text = $("#clock-text");

      // ç”» 12 ä¸ªåˆ»åº¦
      for (let i = 0; i < 12; i++) {
        const mark = document.createElement("span");
        mark.style.transform = `translateX(-50%) rotate(${i * 30}deg)`;
        marks.appendChild(mark);
      }

      const update = (h) => {
        const hour = ((h - 1 + 12) % 12) + 1;
        slider.value = hour;
        const deg = hour * 30;
        hand.style.transform = `translateX(-50%) rotate(${deg}deg)`;
        text.textContent = `å°ç«è½¦åœ¨ ${hour}:00 å‘è½¦ï¼Œå°æœ‹å‹æå‰ 10 åˆ†é’Ÿåˆ°ç«™å“¦ï¼`;
      };

      $("#next-train").addEventListener("click", () => update(Number(slider.value) + 1));
      $("#prev-train").addEventListener("click", () => update(Number(slider.value) - 1));
      slider.addEventListener("input", (e) => update(Number(e.target.value)));
      update(Number(slider.value));
    }

    // 7) æ¤ç‰©æˆé•¿
    function initPlant() {
      const stem = $("#plant-stem");
      const flower = $("#plant-flower");
      const text = $("#plant-text");
      const stages = [
        { height: 20, msg: "ç§å­ç¡åœ¨åœŸé‡Œï¼Œç­‰å¾…æ°´åˆ†ã€‚" },
        { height: 70, msg: "å«©èŠ½æ¢å‡ºå¤´ï¼Œå¶å­èˆ’å±•å¼€ã€‚" },
        { height: 110, msg: "å¼€èŠ±å•¦ï¼é˜³å…‰å’Œæ°´è®©å®ƒé•¿å¾—çœŸå¥½ã€‚" }
      ];
      let step = 0;

      const applyStage = () => {
        stem.style.height = `${stages[step].height}px`;
        flower.classList.toggle("show", step === 2);
        text.textContent = stages[step].msg;
      };

      const grow = () => {
        if (step < stages.length - 1) {
          step += 1;
          applyStage();
        }
      };

      $("#water-btn").addEventListener("click", grow);
      $("#sun-btn").addEventListener("click", grow);
      applyStage();
    }

    // 8) å¤©æ°”
    function initWeather() {
      const box = $("#weather-box");
      const sun = $("#weather-sun");
      const cloud = $("#weather-cloud");
      const emoji = $("#weather-emoji");
      const text = $("#weather-text");
      const rainLayer = $("#rain-layer");

      // é¢„æ”¾ä¸€äº›é›¨æ»´å…ƒç´ ä»¥å¾ªç¯åŠ¨ç”»
      for (let i = 0; i < 12; i++) {
        const drop = document.createElement("span");
        drop.className = "raindrop";
        drop.style.left = `${8 + i * 7}%`;
        drop.style.animationDelay = `${i * 80}ms`;
        rainLayer.appendChild(drop);
      }

      const setWeather = (mode) => {
        sun.classList.toggle("show", mode === "sunny");
        cloud.classList.toggle("show", mode === "cloudy" || mode === "rainy");
        rainLayer.querySelectorAll(".raindrop").forEach((d) => {
          d.style.opacity = mode === "rainy" ? 1 : 0;
        });
        if (mode === "sunny") {
          box.style.background = "linear-gradient(180deg, #81d4fa, #4fc3f7)";
          emoji.textContent = "â˜€ï¸";
          text.textContent = "æ™´æœ—ï¼šæˆ´å¸½å­ã€å¤šå–æ°´ï¼Œæˆ·å¤–è¿åŠ¨å¥½æ—¶æœºã€‚";
        } else if (mode === "cloudy") {
          box.style.background = "linear-gradient(180deg, #90a4ae, #cfd8dc)";
          emoji.textContent = "â›…ï¸";
          text.textContent = "å¤šäº‘ï¼šæ¸©å·®ç¨å¤§ï¼Œè®°å¾—å¸¦è–„å¤–å¥—ã€‚";
        } else {
          box.style.background = "linear-gradient(180deg, #5c6bc0, #3949ab)";
          emoji.textContent = "ğŸŒ§ï¸";
          text.textContent = "ä¸‹é›¨ï¼šç©¿é›¨è¡£æˆ´é›¨é‹ï¼Œå°å¿ƒè·¯æ»‘ã€‚";
        }
      };

      document.querySelectorAll("[data-weather]").forEach((btn) => {
        btn.addEventListener("click", () => setWeather(btn.dataset.weather));
      });

      setWeather("sunny");
    }

    // å·¥å…·å‡½æ•°
    const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
    const clamp = (v, min, max) => Math.min(Math.max(v, min), max);
  </script>
</body>
</html>
